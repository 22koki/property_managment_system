<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rental Billing Statement Generator</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        /* Custom CSS */
        body {
            background-color: #f8f9fa;
            font-family: 'Arial', sans-serif;
        }
        .container {
            max-width: 900px;
            margin-top: 50px;
        }
        .form-group {
            margin-bottom: 1.5rem;
        }
        .statement-container {
            background-color: #ffffff;
            padding: 30px;
            margin-top: 50px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .statement-container h3 {
            margin-bottom: 20px;
        }
        .btn-primary, .btn-success, .btn-info, .btn-danger {
            width: 100%;
            margin-top: 15px;
        }
        .btn-primary {
            background-color: #4CAF50; /* Green */
            border-color: #4CAF50;
        }
        .btn-success {
            background-color: #008CBA; /* Blue */
            border-color: #008CBA;
        }
        .btn-info {
            background-color: #FFC107; /* Yellow */
            border-color: #FFC107;
        }
        .btn-danger {
            background-color: #f44336; /* Red */
            border-color: #f44336;
        }
        .table th, .table td {
            text-align: center;
        }
        header {
            text-align: left;
            margin-bottom: 30px;
            position: relative;
        }
        header .logo img {
            width: 120px;
            height: auto;
        }
        header h1 {
            margin-top: 10px;
            font-size: 2rem;
            color: #333;
        }
        header p {
            font-size: 1rem;
            color: #777;
        }
        .side-by-side {
            display: flex;
            justify-content: space-between;
        }
        .side-by-side .form-group {
            width: 48%;
        }
        .bottom-right {
            position: fixed;
            bottom: 10px;
            right: 20px;
            font-size: 1.2rem;
            font-weight: bold;
        }
        .balance-due {
            margin-top: 20px;
        }
        .statement-preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .statement-preview-header h3 {
            margin-bottom: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <img src="/property_management/static/uploads/t.png" alt="ZURIPO Logo">
            </div>
            <h1>ZURIPO Property Specialists</h1>
            <p>Location: Garden Estate, Off Northern Bypass, Nairobi</p>
            <p>Phone: +254 792 262 000 | Email: info@zuripoproperties.co.ke</p>
            <h2>Slogan: We Manage, We Rent, We Sell</h2>
        </header>

        <h2 class="text-center">Rental Billing Statement Generator</h2>

        <!-- Form for input -->
        <form id="billingForm">
            <!-- Tenant and Property Info -->
            <fieldset class="mb-4">
                <legend>Tenant and Property Information</legend>
                <div class="side-by-side">
                    <div class="form-group">
                        <input type="text" class="form-control" id="tenantName" placeholder="Tenant Name" required>
                    </div>
                    <div class="form-group">
                        <input type="text" class="form-control" id="tenantLocation" placeholder="Location" required>
                    </div>
                </div>
                <div class="side-by-side">
                    <div class="form-group">
                        <input type="text" class="form-control" id="tenantPhone" placeholder="Phone" required>
                    </div>
                    <div class="form-group">
                        <input type="email" class="form-control" id="tenantEmail" placeholder="Email" required>
                    </div>
                </div>
                <div class="side-by-side">
                    <div class="form-group">
                        <input type="text" class="form-control" id="propertyLocation" placeholder="Property Location" required>
                    </div>
                    <div class="form-group">
                        <input type="text" class="form-control" id="propertyOwner" placeholder="Property Owner" required>
                    </div>
                </div>
            </fieldset>

            <!-- Account Activity -->
            <fieldset class="mb-4">
                <legend>Account Activity</legend>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Reference</th>
                            <th>Description</th>
                            <th>Debit (Ksh)</th>
                            <th>Credit (Ksh)</th>
                            <th>Amount (Ksh)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><input type="text" class="form-control" id="activityDate" placeholder="Date" required></td>
                            <td><input type="text" class="form-control" id="activityRef" placeholder="Reference" required></td>
                            <td><input type="text" class="form-control" id="activityDesc" placeholder="Description" required></td>
                            <td><input type="number" class="form-control" id="activityDebit" placeholder="Debit (Ksh)" required></td>
                            <td><input type="number" class="form-control" id="activityCredit" placeholder="Credit (Ksh)" required></td>
                            <td><input type="number" class="form-control" id="activityAmount" placeholder="Amount (Ksh)" required></td>
                        </tr>
                    </tbody>
                </table>
            </fieldset>

            <!-- Payment Info -->
            <fieldset class="mb-4">
                <legend>Payment Information</legend>
                <div class="form-group">
                    <input type="text" class="form-control" id="bankName" placeholder="Bank Name" required>
                </div>
                <div class="form-group">
                    <input type="text" class="form-control" id="accountNumber" placeholder="Account Number" required>
                </div>
                <div class="form-group">
                    <input type="text" class="form-control" id="mpesaPaybill" placeholder="M-Pesa Paybill" required>
                </div>
                <div class="form-group">
                    <input type="text" class="form-control" id="mpesaAccount" placeholder="Bank Account (M-Pesa)" required>
                </div>
            </fieldset>

            <!-- Button to generate statement -->
            <button type="button" class="btn btn-primary" onclick="generateStatement()">Generate Statement</button>
        </form>
    </div>

    <!-- Statement Preview Section -->
    <div class="container statement-container" id="statementPreview" style="display: none;">
        <div class="statement-preview-header">
            <h3>Rental Billing Statement</h3>
            <div class="balance-due">
                <p><strong>Due Date:</strong> <span id="dueDate"></span></p>
                <p><strong>Balance Due:</strong> <span id="finalBalance"></span></p>
            </div>
        </div>
        <div id="statementOutput"></div>
        <button class="btn btn-success" id="downloadPdf" onclick="downloadPDF()">Download as PDF</button>
        <button class="btn btn-info" id="saveCloud" onclick="saveToCloud()">Save to Cloud</button>
        <button class="btn btn-danger" id="deletePdf" onclick="deletePDF()">Delete</button>
    </div>

    <div class="bottom-right">
        <p><strong>Due Date:</strong> <span id="dueDate"></span></p>
        <p><strong>Balance Due:</strong> <span id="finalBalance"></span></p>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <script>
        function generateStatement() {
            // Get form values
            const tenantName = document.getElementById('tenantName').value;
            const tenantLocation = document.getElementById('tenantLocation').value;
            const tenantPhone = document.getElementById('tenantPhone').value;
            const tenantEmail = document.getElementById('tenantEmail').value;
            const propertyLocation = document.getElementById('propertyLocation').value;
            const propertyOwner = document.getElementById('propertyOwner').value;
            
            const activityDate = document.getElementById('activityDate').value;
            const activityRef = document.getElementById('activityRef').value;
            const activityDesc = document.getElementById('activityDesc').value;
            const activityDebit = document.getElementById('activityDebit').value;
            const activityCredit = document.getElementById('activityCredit').value;
            const activityAmount = document.getElementById('activityAmount').value;
            
            const bankName = document.getElementById('bankName').value;
            const accountNumber = document.getElementById('accountNumber').value;
            const mpesaPaybill = document.getElementById('mpesaPaybill').value;
            const mpesaAccount = document.getElementById('mpesaAccount').value;

            const dueDate = new Date().toLocaleDateString();
            const balanceDue = 1000; // Set the final balance dynamically based on user input

            document.getElementById('dueDate').textContent = dueDate;
            document.getElementById('finalBalance').textContent = balanceDue;

            // Format the account activity in a table
            const activityTable = `
                <h3>Account Activity</h3>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Reference</th>
                            <th>Description</th>
                            <th>Debit (Ksh)</th>
                            <th>Credit (Ksh)</th>
                            <th>Amount (Ksh)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>${activityDate}</td>
                            <td>${activityRef}</td>
                            <td>${activityDesc}</td>
                            <td>${activityDebit}</td>
                            <td>${activityCredit}</td>
                            <td>${activityAmount}</td>
                        </tr>
                    </tbody>
                </table>
            `;

            // Display the statement preview
            document.getElementById('statementPreview').style.display = 'block';
            document.getElementById('statementOutput').innerHTML = `
                <h3>Rental Statement for ${tenantName}</h3>
                <p><strong>Tenant Location:</strong> ${tenantLocation}</p>
                <p><strong>Tenant Phone:</strong> ${tenantPhone}</p>
                <p><strong>Tenant Email:</strong> ${tenantEmail}</p>
                <p><strong>Property Location:</strong> ${propertyLocation}</p>
                <p><strong>Property Owner:</strong> ${propertyOwner}</p>
                ${activityTable}
            `;
        }

        function downloadPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            doc.html(document.querySelector("#statementPreview"), {
                callback: function (doc) {
                    doc.save("Rental_Statement.pdf");
                }
            });
        }

        function saveToCloud() {
            alert("Cloud saving is currently not available.");
        }

        function deletePDF() {
            alert("PDF file deleted.");
        }
    </script>
</body>
</html>
